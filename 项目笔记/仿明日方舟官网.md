# 简介

**介绍**

仿 [明日方舟官网](https://ak.hypergryph.com/index)，版本2020年12月，仅供学习交流用

**简单粗暴的实现流程**

- DOM结构：从页面上直接扒下来！

- 静态资源：从页面上直接扒下来！
- 样式配置：从页面上直接扒下来！

- JS脚本交互：这个不是很好扒下来，操作页面凭感觉实现
- 后端服务和数据设计：这个是隐性的，只能凭想象力去设计并实现类似功能，这个暂时不需要而且很难放到后面功能用到再写

```
当然还要考虑用户动作对dom结构和样式的影响，如果使用less或者scss还要考虑哪些样式可以提取出来，还是很麻烦的
```

**技术栈：**

- react
- typescript

- sass

**Github地址**

```
https://github.com/magezee/mrfz.git
```

**动画及效果**

有些动画效果不好文字描述，如果想了解具体效果可以去官网或者在线项目体验



----

# 前端

## 初始化

使用脚手架生成ts项目

```js
npx create-react-app mrfz --template typescript
```

生成的项目把没必要的内容删掉，比如 `index.css` 啥的，然后先改写 `index.html` 文件，主要是meta标签，直接从官网上扒下来即可，修改后的 `index.html` 如下，记得图标 `favicon.ico`

**header内容**

<img src="https://img-blog.csdnimg.cn/20201221154417599.png" style="margin:0">

```html
<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1">
    <meta name="keywords" content="明日方舟,明日方舟官网,明日方舟手游,二次元,明日方舟Arknights,魔物娘,战棋,策略,塔防,塔防RPG,Arknights,人外,Monster">
    <meta name="description" content="《明日方舟》是一款魔物主题的策略手游。在游戏中，玩家将管理一艘满载“ 魔物干员”的方舟，为调查来源神秘的矿石灾难而踏上旅途。在这个宽广而危机四伏的世界中，你或许会看到废土中的城市废墟，或许会看到仿若幻境的亚人国度，或许会遭遇无法解读的神秘，或许参与无比残酷的战争。在有关幻想与异种生命的世界中，体验史诗与想象，情感与牵绊！">
    <meta rel="shortcut icon" href="%PUBLIC_URL%/favicon.ico">
    <link rel="stylesheet" href="%PUBLIC_URL%/html.css"> 
    <title>明日方舟 - Arknights</title>
  </head>
  <body>
    <div class="wrap pc ready"></div>
  </body>
</html>
```

**body内容**

先给项目整体规划，整体是一个大的 `<div class="wrap pc ready"/>` （本次项目只考虑pc浏览页面）包裹页面所有内容

<img src="https://img-blog.csdnimg.cn/20201221154832575.png" style="margin:0">

`section` 对应的是官网的主要几个部分内容（个人中心是跳转到另外一个页面，这个另算，因此只有五部分）

<img src="https://img-blog.csdnimg.cn/20201221155100753.png" style="margin:0;width:150px">

由此可以修改 react 中的 `src/App.tsx` 文件，规划好总体的页面部分

```tsx
const App:React.FC = () => {
    return (
        <React.Fragment>
            <header id="header">头栏</header>
            <div className="section">首页</div>
            <div className="section">情报</div>
            <div className="section">干员</div>
            <div className="section">世界观</div>
            <div className="section">档案</div>
            <footer>尾栏</footer>
        </React.Fragment>
    );
}
```

但是  react 项目中，`App` 的功能一般是配置路由，并通过指定渲染指定的页面组件，因此下面配置 react 路由

```
npm install react-router-dom @types/react-router-dom -s
```

先建立 `src/Views` 目录，该目录下文件内容如下

```tsx
// src/Views/Index/index.tsx
import React from 'react';

const Index:React.FC = () =>  {
	return (
		<React.Fragment>
			<header id="header">头栏</header>
			<div className="section">首页</div>
			<div className="section">情报</div>
			<div className="section">干员</div>
			<div className="section">世界观</div>
			<div className="section">档案</div>
			<footer>尾栏</footer>
		</React.Fragment>
	);
}

export default Index;
```

目前这里只是用于初始化展示确认功能没问题，后面具体的这些容器元素都会写在具体的容器组件中，Index组件到时直接渲染各个组件就行，比如后面可能会修改成下面这样

```tsx
<React.Fragment>
    <Header />
    <Home />
    <News />
    <Characters />
    <Story />
    <Archive />
    <Footer />
</React.Fragment>
```

使用一个文件导出全部页面组件，本次项目中很多地方都会用到这一文件管理技巧

```tsx
// src/Views/index.ts
import Index from './Index/index.tsx';

export {
    Index,
}
```

修改 `App.tsx` 文件，配置路由

```tsx
import React from 'react';
import { BrowserRouter, Route, Switch, Redirect } from 'react-router-dom'

import { Index } from './Views';

const App:React.FC = () => {
	return (
		<React.Fragment>
			<BrowserRouter>
				<Switch>
					<Route component={Index} path='/index' exact />
					<Redirect to='/index' from='/' />
        		</Switch>
			</BrowserRouter>
		</React.Fragment>
	);
}

export default App;
```

**基本样式**

样式思路就是从原网页上直接扒下来

本次使用的预处理器为 `scss`，需下载配置包，使用 `4.14.0` 版本是因为高版本的 `node-sass` 可能会安装不成功，需要 cnpm 下载，为了方便直接下载可用版本

```
npm install node-sass@4.14.0 -s
```

基本的HTML样式

```scss
// public/html.css
html {
    font-size: 16px;
    color: #fff;
    font-family: sans-serif;
}

body {
    margin: 0;
}
```

页面容器样式

```scss
// src/style.scss
.wrap {
    position: relative;
    font-size: 100%;
    width: 100%;
    overflow: hidden;
    font-family: SourceHanSansSubset,'Hiragino Sans GB','Microsoft YaHei',sans-serif;
    background: fixed no-repeat center top;
    background-size: cover;
}

.wrap.pc {
    min-width: 1400px;
    background-image: url('./assets/index/images/bk.jpg');
}

@media (max-width: 1600px) {
    .wrap.pc {
        font-size: 14px;
    }
}
```

由此完成基本的项目初始化，接下来开始仔细设计具体功能



---

## header部分

header 包含两个部分内容：

- 左边的导航栏
- 右边的快捷菜单

<img src="https://img-blog.csdnimg.cn/2020122309571059.png" style="margin:0;">

-----

### 导航栏

**功能及效果**

- 未点击时，呈现的是一个三横线图案

<img src="https://img-blog.csdnimg.cn/20201223100622637.png" style="margin:0">

- 点击后横线变成 `X`，有补间动画，且展示导航栏中具体内容

<img src="https://img-blog.csdnimg.cn/20201221155100753.png" style="margin:0;width:120px">

- 点击导航栏中的指定内容，页面滑动到该内容范围锚点，并且导航栏重置为折叠状态

由于目前并未完成其他页面，因此现在只负责导航栏的展示功能

---

**HTML元素设计**

通过更改容器 `class` 的名字，来为容器编写两套 CSS 从而实现样式变化 

折叠状态HTML，不渲染导航菜单

```html
<div class="header collapsed">
    <a href="javascript:" class="button-menu collapsed">
        <span class="button-bar"></span>
        <span class="button-bar"></span>
        <span class="button-bar"></span>
    </a>
</div>
```

展开状态的HTML，更改容器 `class` 并渲染导航菜单

```html
<div class="header expanded">
    <a href="javascript:" class="button-menu expanded">
        <span class="button-bar"></span>
        <span class="button-bar"></span>
        <span class="button-bar"></span>
    </a>
    <div class="header-menu">...</div>
</div>
```

一个导航内容由几部分组成：

<img src="https://img-blog.csdnimg.cn/20201223103145312.png" style="margin:0">

- 一个 `<a>` 标签作为容器表示可点击范围，点击跳转至指定内容锚点（个人中心是跳转页面）
- 一个背景淡色英文文字
- 导航内容文字，前面的横线可以使用伪元素来制作
- 当前页面浏览的内容对应导航栏内容，且该为该导航内容添加类名 `current` 表示当前选中

```html
<a href="/index#title" class="nav-link current">
	<span class="nav-link-name-e">Home</span>
    <span class="nav-link-name twoL">首页</span>
</a>
```

由此，可以把导航菜单栏内容补充完整，注意有些类名不同

```html
<div class="header-menu">
    <nav class="nav-links">
    	<a href="/index#!title" class="nav-link current">
			<span class="nav-link-name-e">Home</span>
    		<span class="nav-link-name twoL">首页</span>
		</a>
        <a href="/index#!news" class="nav-link">
			<span class="nav-link-name-e">News</span>
    		<span class="nav-link-name twoL">情报</span>
		</a>
        <a href="/index#!characters" class="nav-link">
			<span class="nav-link-name-e">Character</span>
    		<span class="nav-link-name twoL">干员</span>
		</a>
        <a href="/index#!story" class="nav-link">
			<span class="nav-link-name-e">Story</span>
    		<span class="nav-link-name thrL">世界观</span>
		</a>
        <a href="/index#!archive" class="nav-link">
			<span class="nav-link-name-e">Archive</span>
    		<span class="nav-link-name twoL">档案</span>
		</a>
        <a href="/user" class="nav-link">
			<span class="nav-link-name-e">Dashboard</span>
    		<span class="nav-link-name fouL">个人中心</span>
		</a>
    </nav>
</div>
```

----

**React代码实现**

导航栏基础部分：

```tsx
// src/Components/Header/Navigation/index.tsx
import React from 'react';

const Navigation:React.FC = () => {
    return (
        <React.Fragment>
            <div className="header collapsed">
                <a href="javascript:" className="button-menu collapsed">
                    <span className="button-bar"></span>
                    <span className="button-bar"></span>
                    <span className="button-bar"></span>
                </a>
            </div>
        </React.Fragment>
    )
}

export default Navigation;
```

为了确定是否展开状态，引入 `useState` 保存一个状态值，同时下载第三方包 `classnames` 来动态更改元素的 className

```
npm install classname @types/classnames -s
```

```tsx

```

